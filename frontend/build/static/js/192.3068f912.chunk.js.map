{"version":3,"file":"static/js/192.3068f912.chunk.js","mappings":"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","sources":["pages/auth/EntraAuth.js"],"sourcesContent":["/**\n * EntraAuth.js - Microsoft Entra ID Authentication\n * eSIM Enterprise Management Portal\n * \n * Tenant ID: 370dd52c-929e-4fcd-aee3-fb5181eff2b7\n * Client ID: 00f56c44-2d00-4378-bb52-1417c208fcfd\n * Redirect URI: https://www.esim.com.mm/auth\n */\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { useNavigate, useSearchParams } from 'react-router-dom';\nimport { motion } from 'framer-motion';\n\n// Microsoft Entra ID Configuration\nconst ENTRA_CONFIG = {\n  tenantId: '370dd52c-929e-4fcd-aee3-fb5181eff2b7',\n  clientId: '00f56c44-2d00-4378-bb52-1417c208fcfd',\n  redirectUri: 'https://www.esim.com.mm/auth',\n  scopes: ['openid', 'profile', 'email', 'User.Read'],\n  \n  // Endpoints\n  authorizeEndpoint: 'https://login.microsoftonline.com/370dd52c-929e-4fcd-aee3-fb5181eff2b7/oauth2/v2.0/authorize',\n  tokenEndpoint: 'https://login.microsoftonline.com/370dd52c-929e-4fcd-aee3-fb5181eff2b7/oauth2/v2.0/token',\n  graphEndpoint: 'https://graph.microsoft.com/v1.0/me',\n  openIdConfig: 'https://login.microsoftonline.com/370dd52c-929e-4fcd-aee3-fb5181eff2b7/v2.0/.well-known/openid-configuration'\n};\n\n// Generate random state for CSRF protection\nconst generateState = () => {\n  const array = new Uint8Array(32);\n  window.crypto.getRandomValues(array);\n  return Array.from(array, byte => byte.toString(16).padStart(2, '0')).join('');\n};\n\n// Generate PKCE code verifier and challenge\nconst generatePKCE = async () => {\n  const verifier = generateState();\n  const encoder = new TextEncoder();\n  const data = encoder.encode(verifier);\n  const hash = await window.crypto.subtle.digest('SHA-256', data);\n  const challenge = btoa(String.fromCharCode(...new Uint8Array(hash)))\n    .replace(/\\+/g, '-')\n    .replace(/\\//g, '_')\n    .replace(/=+$/, '');\n  return { verifier, challenge };\n};\n\nconst EntraAuth = () => {\n  const navigate = useNavigate();\n  const [searchParams] = useSearchParams();\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [user, setUser] = useState(null);\n\n  // Handle OAuth callback\n  const handleCallback = useCallback(async () => {\n    const code = searchParams.get('code');\n    const state = searchParams.get('state');\n    const errorParam = searchParams.get('error');\n    const errorDescription = searchParams.get('error_description');\n\n    if (errorParam) {\n      setError(`${errorParam}: ${errorDescription}`);\n      return;\n    }\n\n    if (code) {\n      setLoading(true);\n      \n      // Verify state\n      const savedState = sessionStorage.getItem('entra_state');\n      if (state !== savedState) {\n        setError('State mismatch - possible CSRF attack');\n        setLoading(false);\n        return;\n      }\n\n      try {\n        // Get code verifier for PKCE\n        const codeVerifier = sessionStorage.getItem('entra_code_verifier');\n        \n        // Exchange code for token\n        const tokenResponse = await fetch(ENTRA_CONFIG.tokenEndpoint, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/x-www-form-urlencoded'\n          },\n          body: new URLSearchParams({\n            client_id: ENTRA_CONFIG.clientId,\n            grant_type: 'authorization_code',\n            code: code,\n            redirect_uri: ENTRA_CONFIG.redirectUri,\n            code_verifier: codeVerifier\n          })\n        });\n\n        if (!tokenResponse.ok) {\n          throw new Error('Token exchange failed');\n        }\n\n        const tokens = await tokenResponse.json();\n        \n        // Store tokens\n        localStorage.setItem('entra_access_token', tokens.access_token);\n        if (tokens.refresh_token) {\n          localStorage.setItem('entra_refresh_token', tokens.refresh_token);\n        }\n        localStorage.setItem('entra_id_token', tokens.id_token);\n\n        // Fetch user profile from Microsoft Graph\n        const userResponse = await fetch(ENTRA_CONFIG.graphEndpoint, {\n          headers: {\n            'Authorization': `Bearer ${tokens.access_token}`\n          }\n        });\n\n        if (userResponse.ok) {\n          const userData = await userResponse.json();\n          setUser(userData);\n          localStorage.setItem('entra_user', JSON.stringify(userData));\n          \n          // Clear session storage\n          sessionStorage.removeItem('entra_state');\n          sessionStorage.removeItem('entra_code_verifier');\n          \n          // Redirect to dashboard after 2 seconds\n          setTimeout(() => navigate('/dashboard'), 2000);\n        }\n      } catch (err) {\n        setError(err.message);\n      } finally {\n        setLoading(false);\n      }\n    }\n  }, [searchParams, navigate]);\n\n  useEffect(() => {\n    handleCallback();\n  }, [handleCallback]);\n\n  // Initiate login\n  const handleLogin = async () => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      // Generate PKCE\n      const { verifier, challenge } = await generatePKCE();\n      const state = generateState();\n\n      // Store for callback verification\n      sessionStorage.setItem('entra_state', state);\n      sessionStorage.setItem('entra_code_verifier', verifier);\n\n      // Build authorization URL\n      const authUrl = new URL(ENTRA_CONFIG.authorizeEndpoint);\n      authUrl.searchParams.set('client_id', ENTRA_CONFIG.clientId);\n      authUrl.searchParams.set('response_type', 'code');\n      authUrl.searchParams.set('redirect_uri', ENTRA_CONFIG.redirectUri);\n      authUrl.searchParams.set('scope', ENTRA_CONFIG.scopes.join(' '));\n      authUrl.searchParams.set('state', state);\n      authUrl.searchParams.set('code_challenge', challenge);\n      authUrl.searchParams.set('code_challenge_method', 'S256');\n      authUrl.searchParams.set('response_mode', 'query');\n\n      // Redirect to Microsoft login\n      window.location.href = authUrl.toString();\n    } catch (err) {\n      setError(err.message);\n      setLoading(false);\n    }\n  };\n\n  // Logout\n  const handleLogout = () => {\n    localStorage.removeItem('entra_access_token');\n    localStorage.removeItem('entra_refresh_token');\n    localStorage.removeItem('entra_id_token');\n    localStorage.removeItem('entra_user');\n    setUser(null);\n    \n    // Redirect to Microsoft logout\n    const logoutUrl = `https://login.microsoftonline.com/${ENTRA_CONFIG.tenantId}/oauth2/v2.0/logout?post_logout_redirect_uri=${encodeURIComponent(ENTRA_CONFIG.redirectUri)}`;\n    window.location.href = logoutUrl;\n  };\n\n  // Check for existing session\n  useEffect(() => {\n    const savedUser = localStorage.getItem('entra_user');\n    if (savedUser) {\n      setUser(JSON.parse(savedUser));\n    }\n  }, []);\n\n  return (\n    <div className=\"min-h-screen py-20 flex items-center justify-center\">\n      <div className=\"max-w-md w-full mx-4\">\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"glass-card text-center\"\n        >\n          {/* Logo */}\n          <div className=\"mb-8\">\n            <div className=\"w-20 h-20 mx-auto mb-4 rounded-2xl bg-gradient-to-br from-primary to-blue-500 flex items-center justify-center\">\n              <svg className=\"w-10 h-10 text-background\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path d=\"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5\"/>\n              </svg>\n            </div>\n            <h1 className=\"text-2xl font-bold text-white mb-2\">\n              eSIM Enterprise Portal\n            </h1>\n            <p className=\"text-gray-400 text-sm\">\n              Microsoft Entra ID Authentication\n            </p>\n          </div>\n\n          {/* Error Message */}\n          {error && (\n            <div className=\"mb-6 p-4 bg-red-500/20 border border-red-500/30 rounded-lg\">\n              <p className=\"text-red-400 text-sm\">{error}</p>\n            </div>\n          )}\n\n          {/* User Profile (if logged in) */}\n          {user ? (\n            <div className=\"space-y-6\">\n              <div className=\"p-4 bg-green-500/20 border border-green-500/30 rounded-lg\">\n                <p className=\"text-green-400 text-sm mb-2\">Authenticated Successfully</p>\n                <p className=\"text-white font-semibold\">{user.displayName}</p>\n                <p className=\"text-gray-400 text-sm\">{user.mail || user.userPrincipalName}</p>\n              </div>\n\n              <div className=\"text-left space-y-2 p-4 bg-white/5 rounded-lg\">\n                <p className=\"text-xs text-gray-500\">User ID</p>\n                <p className=\"text-sm text-gray-300 font-mono break-all\">{user.id}</p>\n              </div>\n\n              <div className=\"flex gap-3\">\n                <button\n                  onClick={() => navigate('/dashboard')}\n                  className=\"flex-1 btn-primary\"\n                >\n                  Go to Dashboard\n                </button>\n                <button\n                  onClick={handleLogout}\n                  className=\"flex-1 btn-secondary\"\n                >\n                  Sign Out\n                </button>\n              </div>\n            </div>\n          ) : (\n            <div className=\"space-y-6\">\n              {/* Login Button */}\n              <button\n                onClick={handleLogin}\n                disabled={loading}\n                className=\"w-full btn-primary flex items-center justify-center gap-3\"\n              >\n                {loading ? (\n                  <div className=\"w-5 h-5 border-2 border-background border-t-transparent rounded-full animate-spin\" />\n                ) : (\n                  <svg className=\"w-5 h-5\" viewBox=\"0 0 21 21\" fill=\"currentColor\">\n                    <rect x=\"1\" y=\"1\" width=\"9\" height=\"9\" fill=\"#f25022\"/>\n                    <rect x=\"11\" y=\"1\" width=\"9\" height=\"9\" fill=\"#7fba00\"/>\n                    <rect x=\"1\" y=\"11\" width=\"9\" height=\"9\" fill=\"#00a4ef\"/>\n                    <rect x=\"11\" y=\"11\" width=\"9\" height=\"9\" fill=\"#ffb900\"/>\n                  </svg>\n                )}\n                {loading ? 'Signing in...' : 'Sign in with Microsoft'}\n              </button>\n\n              {/* Divider */}\n              <div className=\"flex items-center gap-4\">\n                <div className=\"flex-1 h-px bg-white/10\"></div>\n                <span className=\"text-gray-500 text-sm\">or</span>\n                <div className=\"flex-1 h-px bg-white/10\"></div>\n              </div>\n\n              {/* Alternative Login */}\n              <button\n                onClick={() => navigate('/login')}\n                className=\"w-full btn-secondary\"\n              >\n                Sign in with Email\n              </button>\n            </div>\n          )}\n\n          {/* Footer Info */}\n          <div className=\"mt-8 pt-6 border-t border-white/10\">\n            <p className=\"text-xs text-gray-500 mb-2\">\n              Enterprise Single Sign-On\n            </p>\n            <p className=\"text-xs text-gray-600\">\n              Tenant: {ENTRA_CONFIG.tenantId.substring(0, 8)}...\n            </p>\n          </div>\n        </motion.div>\n      </div>\n    </div>\n  );\n};\n\nexport default EntraAuth;\n"],"names":["ENTRA_CONFIG","tenantId","clientId","redirectUri","scopes","authorizeEndpoint","tokenEndpoint","graphEndpoint","openIdConfig","generateState","array","Uint8Array","window","crypto","getRandomValues","Array","from","byte","toString","padStart","join","EntraAuth","navigate","useNavigate","searchParams","useSearchParams","loading","setLoading","useState","error","setError","user","setUser","handleCallback","useCallback","async","code","get","state","errorParam","errorDescription","concat","sessionStorage","getItem","codeVerifier","tokenResponse","fetch","method","headers","body","URLSearchParams","client_id","grant_type","redirect_uri","code_verifier","ok","Error","tokens","json","localStorage","setItem","access_token","refresh_token","id_token","userResponse","userData","JSON","stringify","removeItem","setTimeout","err","message","useEffect","savedUser","parse","_jsx","className","children","_jsxs","motion","div","initial","opacity","y","animate","fill","viewBox","d","displayName","mail","userPrincipalName","id","onClick","handleLogout","logoutUrl","encodeURIComponent","location","href","verifier","challenge","data","TextEncoder","encode","hash","subtle","digest","btoa","String","fromCharCode","replace","generatePKCE","authUrl","URL","set","disabled","x","width","height","substring"],"ignoreList":[],"sourceRoot":""}