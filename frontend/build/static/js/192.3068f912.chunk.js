"use strict";(self.webpackChunkesim_myanmar_frontend=self.webpackChunkesim_myanmar_frontend||[]).push([[192],{9192(e,t,s){s.r(t),s.d(t,{default:()=>l});var r=s(5043),a=s(5685),n=s(402),o=s(579);const i={tenantId:"370dd52c-929e-4fcd-aee3-fb5181eff2b7",clientId:"00f56c44-2d00-4378-bb52-1417c208fcfd",redirectUri:"https://www.esim.com.mm/auth",scopes:["openid","profile","email","User.Read"],authorizeEndpoint:"https://login.microsoftonline.com/370dd52c-929e-4fcd-aee3-fb5181eff2b7/oauth2/v2.0/authorize",tokenEndpoint:"https://login.microsoftonline.com/370dd52c-929e-4fcd-aee3-fb5181eff2b7/oauth2/v2.0/token",graphEndpoint:"https://graph.microsoft.com/v1.0/me",openIdConfig:"https://login.microsoftonline.com/370dd52c-929e-4fcd-aee3-fb5181eff2b7/v2.0/.well-known/openid-configuration"},c=()=>{const e=new Uint8Array(32);return window.crypto.getRandomValues(e),Array.from(e,e=>e.toString(16).padStart(2,"0")).join("")},l=()=>{const e=(0,a.Zp)(),[t]=(0,a.ok)(),[s,l]=(0,r.useState)(!1),[d,m]=(0,r.useState)(null),[h,f]=(0,r.useState)(null),g=(0,r.useCallback)(async()=>{const s=t.get("code"),r=t.get("state"),a=t.get("error"),n=t.get("error_description");if(a)m("".concat(a,": ").concat(n));else if(s){l(!0);if(r!==sessionStorage.getItem("entra_state"))return m("State mismatch - possible CSRF attack"),void l(!1);try{const t=sessionStorage.getItem("entra_code_verifier"),r=await fetch(i.tokenEndpoint,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:i.clientId,grant_type:"authorization_code",code:s,redirect_uri:i.redirectUri,code_verifier:t})});if(!r.ok)throw new Error("Token exchange failed");const a=await r.json();localStorage.setItem("entra_access_token",a.access_token),a.refresh_token&&localStorage.setItem("entra_refresh_token",a.refresh_token),localStorage.setItem("entra_id_token",a.id_token);const n=await fetch(i.graphEndpoint,{headers:{Authorization:"Bearer ".concat(a.access_token)}});if(n.ok){const t=await n.json();f(t),localStorage.setItem("entra_user",JSON.stringify(t)),sessionStorage.removeItem("entra_state"),sessionStorage.removeItem("entra_code_verifier"),setTimeout(()=>e("/dashboard"),2e3)}}catch(o){m(o.message)}finally{l(!1)}}},[t,e]);(0,r.useEffect)(()=>{g()},[g]);return(0,r.useEffect)(()=>{const e=localStorage.getItem("entra_user");e&&f(JSON.parse(e))},[]),(0,o.jsx)("div",{className:"min-h-screen py-20 flex items-center justify-center",children:(0,o.jsx)("div",{className:"max-w-md w-full mx-4",children:(0,o.jsxs)(n.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"glass-card text-center",children:[(0,o.jsxs)("div",{className:"mb-8",children:[(0,o.jsx)("div",{className:"w-20 h-20 mx-auto mb-4 rounded-2xl bg-gradient-to-br from-primary to-blue-500 flex items-center justify-center",children:(0,o.jsx)("svg",{className:"w-10 h-10 text-background",fill:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{d:"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"})})}),(0,o.jsx)("h1",{className:"text-2xl font-bold text-white mb-2",children:"eSIM Enterprise Portal"}),(0,o.jsx)("p",{className:"text-gray-400 text-sm",children:"Microsoft Entra ID Authentication"})]}),d&&(0,o.jsx)("div",{className:"mb-6 p-4 bg-red-500/20 border border-red-500/30 rounded-lg",children:(0,o.jsx)("p",{className:"text-red-400 text-sm",children:d})}),h?(0,o.jsxs)("div",{className:"space-y-6",children:[(0,o.jsxs)("div",{className:"p-4 bg-green-500/20 border border-green-500/30 rounded-lg",children:[(0,o.jsx)("p",{className:"text-green-400 text-sm mb-2",children:"Authenticated Successfully"}),(0,o.jsx)("p",{className:"text-white font-semibold",children:h.displayName}),(0,o.jsx)("p",{className:"text-gray-400 text-sm",children:h.mail||h.userPrincipalName})]}),(0,o.jsxs)("div",{className:"text-left space-y-2 p-4 bg-white/5 rounded-lg",children:[(0,o.jsx)("p",{className:"text-xs text-gray-500",children:"User ID"}),(0,o.jsx)("p",{className:"text-sm text-gray-300 font-mono break-all",children:h.id})]}),(0,o.jsxs)("div",{className:"flex gap-3",children:[(0,o.jsx)("button",{onClick:()=>e("/dashboard"),className:"flex-1 btn-primary",children:"Go to Dashboard"}),(0,o.jsx)("button",{onClick:()=>{localStorage.removeItem("entra_access_token"),localStorage.removeItem("entra_refresh_token"),localStorage.removeItem("entra_id_token"),localStorage.removeItem("entra_user"),f(null);const e="https://login.microsoftonline.com/".concat(i.tenantId,"/oauth2/v2.0/logout?post_logout_redirect_uri=").concat(encodeURIComponent(i.redirectUri));window.location.href=e},className:"flex-1 btn-secondary",children:"Sign Out"})]})]}):(0,o.jsxs)("div",{className:"space-y-6",children:[(0,o.jsxs)("button",{onClick:async()=>{l(!0),m(null);try{const{verifier:e,challenge:t}=await(async()=>{const e=c(),t=(new TextEncoder).encode(e),s=await window.crypto.subtle.digest("SHA-256",t);return{verifier:e,challenge:btoa(String.fromCharCode(...new Uint8Array(s))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}})(),s=c();sessionStorage.setItem("entra_state",s),sessionStorage.setItem("entra_code_verifier",e);const r=new URL(i.authorizeEndpoint);r.searchParams.set("client_id",i.clientId),r.searchParams.set("response_type","code"),r.searchParams.set("redirect_uri",i.redirectUri),r.searchParams.set("scope",i.scopes.join(" ")),r.searchParams.set("state",s),r.searchParams.set("code_challenge",t),r.searchParams.set("code_challenge_method","S256"),r.searchParams.set("response_mode","query"),window.location.href=r.toString()}catch(e){m(e.message),l(!1)}},disabled:s,className:"w-full btn-primary flex items-center justify-center gap-3",children:[s?(0,o.jsx)("div",{className:"w-5 h-5 border-2 border-background border-t-transparent rounded-full animate-spin"}):(0,o.jsxs)("svg",{className:"w-5 h-5",viewBox:"0 0 21 21",fill:"currentColor",children:[(0,o.jsx)("rect",{x:"1",y:"1",width:"9",height:"9",fill:"#f25022"}),(0,o.jsx)("rect",{x:"11",y:"1",width:"9",height:"9",fill:"#7fba00"}),(0,o.jsx)("rect",{x:"1",y:"11",width:"9",height:"9",fill:"#00a4ef"}),(0,o.jsx)("rect",{x:"11",y:"11",width:"9",height:"9",fill:"#ffb900"})]}),s?"Signing in...":"Sign in with Microsoft"]}),(0,o.jsxs)("div",{className:"flex items-center gap-4",children:[(0,o.jsx)("div",{className:"flex-1 h-px bg-white/10"}),(0,o.jsx)("span",{className:"text-gray-500 text-sm",children:"or"}),(0,o.jsx)("div",{className:"flex-1 h-px bg-white/10"})]}),(0,o.jsx)("button",{onClick:()=>e("/login"),className:"w-full btn-secondary",children:"Sign in with Email"})]}),(0,o.jsxs)("div",{className:"mt-8 pt-6 border-t border-white/10",children:[(0,o.jsx)("p",{className:"text-xs text-gray-500 mb-2",children:"Enterprise Single Sign-On"}),(0,o.jsxs)("p",{className:"text-xs text-gray-600",children:["Tenant: ",i.tenantId.substring(0,8),"..."]})]})]})})})}}}]);
//# sourceMappingURL=192.3068f912.chunk.js.map