{"version":3,"file":"static/js/192.43451428.chunk.js","mappings":"8LAcA,MAAMA,EAAe,CACnBC,SAAU,uCACVC,SAAU,uCACVC,YAAa,+BACbC,OAAQ,CAAC,SAAU,UAAW,QAAS,aAGvCC,kBAAmB,+FACnBC,cAAe,2FACfC,cAAe,sCACfC,aAAc,gHAIVC,EAAgBA,KACpB,MAAMC,EAAQ,IAAIC,WAAW,IAE7B,OADAC,OAAOC,OAAOC,gBAAgBJ,GACvBK,MAAMC,KAAKN,EAAOO,GAAQA,EAAKC,SAAS,IAAIC,SAAS,EAAG,MAAMC,KAAK,KAmR5E,EAnQkBC,KAChB,MAAMC,GAAWC,EAAAA,EAAAA,OACVC,IAAgBC,EAAAA,EAAAA,OAChBC,EAASC,IAAcC,EAAAA,EAAAA,WAAS,IAChCC,EAAOC,IAAYF,EAAAA,EAAAA,UAAS,OAC5BG,EAAMC,IAAWJ,EAAAA,EAAAA,UAAS,MAG3BK,GAAiBC,EAAAA,EAAAA,aAAYC,UACjC,MAAMC,EAAOZ,EAAaa,IAAI,QACxBC,EAAQd,EAAaa,IAAI,SACzBE,EAAaf,EAAaa,IAAI,SAC9BG,EAAmBhB,EAAaa,IAAI,qBAE1C,GAAIE,EACFT,EAAS,GAADW,OAAIF,EAAU,MAAAE,OAAKD,SAI7B,GAAIJ,EAAM,CACRT,GAAW,GAIX,GAAIW,IADeI,eAAeC,QAAQ,eAIxC,OAFAb,EAAS,8CACTH,GAAW,GAIb,IAEE,MAAMiB,EAAeF,eAAeC,QAAQ,uBAGtCE,QAAsBC,MAAM9C,EAAaM,cAAe,CAC5DyC,OAAQ,OACRC,QAAS,CACP,eAAgB,qCAElBC,KAAM,IAAIC,gBAAgB,CACxBC,UAAWnD,EAAaE,SACxBkD,WAAY,qBACZhB,KAAMA,EACNiB,aAAcrD,EAAaG,YAC3BmD,cAAeV,MAInB,IAAKC,EAAcU,GACjB,MAAM,IAAIC,MAAM,yBAGlB,MAAMC,QAAeZ,EAAca,OAGnCC,aAAaC,QAAQ,qBAAsBH,EAAOI,cAC9CJ,EAAOK,eACTH,aAAaC,QAAQ,sBAAuBH,EAAOK,eAErDH,aAAaC,QAAQ,iBAAkBH,EAAOM,UAG9C,MAAMC,QAAqBlB,MAAM9C,EAAaO,cAAe,CAC3DyC,QAAS,CACP,cAAgB,UAADP,OAAYgB,EAAOI,iBAItC,GAAIG,EAAaT,GAAI,CACnB,MAAMU,QAAiBD,EAAaN,OACpC1B,EAAQiC,GACRN,aAAaC,QAAQ,aAAcM,KAAKC,UAAUF,IAGlDvB,eAAe0B,WAAW,eAC1B1B,eAAe0B,WAAW,uBAG1BC,WAAW,IAAM/C,EAAS,cAAe,IAC3C,CACF,CAAE,MAAOgD,GACPxC,EAASwC,EAAIC,QACf,CAAC,QACC5C,GAAW,EACb,CACF,GACC,CAACH,EAAcF,KAElBkD,EAAAA,EAAAA,WAAU,KACRvC,KACC,CAACA,IAwDJ,OAPAuC,EAAAA,EAAAA,WAAU,KACR,MAAMC,EAAYd,aAAahB,QAAQ,cACnC8B,GACFzC,EAAQkC,KAAKQ,MAAMD,KAEpB,KAGDE,EAAAA,EAAAA,KAAA,OAAKC,UAAU,sDAAqDC,UAClEF,EAAAA,EAAAA,KAAA,OAAKC,UAAU,uBAAsBC,UACnCC,EAAAA,EAAAA,MAACC,EAAAA,EAAOC,IAAG,CACTC,QAAS,CAAEC,QAAS,EAAGC,EAAG,IAC1BC,QAAS,CAAEF,QAAS,EAAGC,EAAG,GAC1BP,UAAU,yBAAwBC,SAAA,EAGlCC,EAAAA,EAAAA,MAAA,OAAKF,UAAU,OAAMC,SAAA,EACnBF,EAAAA,EAAAA,KAAA,OAAKC,UAAU,iHAAgHC,UAC7HF,EAAAA,EAAAA,KAAA,OAAKC,UAAU,4BAA4BS,KAAK,eAAeC,QAAQ,YAAWT,UAChFF,EAAAA,EAAAA,KAAA,QAAMY,EAAE,iEAGZZ,EAAAA,EAAAA,KAAA,MAAIC,UAAU,qCAAoCC,SAAC,4BAGnDF,EAAAA,EAAAA,KAAA,KAAGC,UAAU,wBAAuBC,SAAC,yCAMtChD,IACC8C,EAAAA,EAAAA,KAAA,OAAKC,UAAU,6DAA4DC,UACzEF,EAAAA,EAAAA,KAAA,KAAGC,UAAU,uBAAsBC,SAAEhD,MAKxCE,GACC+C,EAAAA,EAAAA,MAAA,OAAKF,UAAU,YAAWC,SAAA,EACxBC,EAAAA,EAAAA,MAAA,OAAKF,UAAU,4DAA2DC,SAAA,EACxEF,EAAAA,EAAAA,KAAA,KAAGC,UAAU,8BAA6BC,SAAC,gCAC3CF,EAAAA,EAAAA,KAAA,KAAGC,UAAU,2BAA0BC,SAAE9C,EAAKyD,eAC9Cb,EAAAA,EAAAA,KAAA,KAAGC,UAAU,wBAAuBC,SAAE9C,EAAK0D,MAAQ1D,EAAK2D,wBAG1DZ,EAAAA,EAAAA,MAAA,OAAKF,UAAU,gDAA+CC,SAAA,EAC5DF,EAAAA,EAAAA,KAAA,KAAGC,UAAU,wBAAuBC,SAAC,aACrCF,EAAAA,EAAAA,KAAA,KAAGC,UAAU,4CAA2CC,SAAE9C,EAAK4D,SAGjEb,EAAAA,EAAAA,MAAA,OAAKF,UAAU,aAAYC,SAAA,EACzBF,EAAAA,EAAAA,KAAA,UACEiB,QAASA,IAAMtE,EAAS,cACxBsD,UAAU,qBAAoBC,SAC/B,qBAGDF,EAAAA,EAAAA,KAAA,UACEiB,QAxEKC,KACnBlC,aAAaS,WAAW,sBACxBT,aAAaS,WAAW,uBACxBT,aAAaS,WAAW,kBACxBT,aAAaS,WAAW,cACxBpC,EAAQ,MAGR,MAAM8D,EAAS,qCAAArD,OAAwCzC,EAAaC,SAAQ,iDAAAwC,OAAgDsD,mBAAmB/F,EAAaG,cAC5JS,OAAOoF,SAASC,KAAOH,GAgETlB,UAAU,uBAAsBC,SACjC,oBAMLC,EAAAA,EAAAA,MAAA,OAAKF,UAAU,YAAWC,SAAA,EAExBC,EAAAA,EAAAA,MAAA,UACEc,QApHMzD,UAClBR,GAAW,GACXG,EAAS,MAET,IAEE,MAAM,SAAEoE,EAAQ,UAAEC,QAhHHhE,WACnB,MAAM+D,EAAWzF,IAEX2F,GADU,IAAIC,aACCC,OAAOJ,GACtBK,QAAa3F,OAAOC,OAAO2F,OAAOC,OAAO,UAAWL,GAK1D,MAAO,CAAEF,WAAUC,UAJDO,KAAKC,OAAOC,gBAAgB,IAAIjG,WAAW4F,KAC1DM,QAAQ,MAAO,KACfA,QAAQ,MAAO,KACfA,QAAQ,MAAO,MAwGwBC,GAChCxE,EAAQ7B,IAGdiC,eAAekB,QAAQ,cAAetB,GACtCI,eAAekB,QAAQ,sBAAuBsC,GAG9C,MAAMa,EAAU,IAAIC,IAAIhH,EAAaK,mBACrC0G,EAAQvF,aAAayF,IAAI,YAAajH,EAAaE,UACnD6G,EAAQvF,aAAayF,IAAI,gBAAiB,QAC1CF,EAAQvF,aAAayF,IAAI,eAAgBjH,EAAaG,aACtD4G,EAAQvF,aAAayF,IAAI,QAASjH,EAAaI,OAAOgB,KAAK,MAC3D2F,EAAQvF,aAAayF,IAAI,QAAS3E,GAClCyE,EAAQvF,aAAayF,IAAI,iBAAkBd,GAC3CY,EAAQvF,aAAayF,IAAI,wBAAyB,QAClDF,EAAQvF,aAAayF,IAAI,gBAAiB,SAG1CrG,OAAOoF,SAASC,KAAOc,EAAQ7F,UACjC,CAAE,MAAOoD,GACPxC,EAASwC,EAAIC,SACb5C,GAAW,EACb,GAwFYuF,SAAUxF,EACVkD,UAAU,4DAA2DC,SAAA,CAEpEnD,GACCiD,EAAAA,EAAAA,KAAA,OAAKC,UAAU,uFAEfE,EAAAA,EAAAA,MAAA,OAAKF,UAAU,UAAUU,QAAQ,YAAYD,KAAK,eAAcR,SAAA,EAC9DF,EAAAA,EAAAA,KAAA,QAAMwC,EAAE,IAAIhC,EAAE,IAAIiC,MAAM,IAAIC,OAAO,IAAIhC,KAAK,aAC5CV,EAAAA,EAAAA,KAAA,QAAMwC,EAAE,KAAKhC,EAAE,IAAIiC,MAAM,IAAIC,OAAO,IAAIhC,KAAK,aAC7CV,EAAAA,EAAAA,KAAA,QAAMwC,EAAE,IAAIhC,EAAE,KAAKiC,MAAM,IAAIC,OAAO,IAAIhC,KAAK,aAC7CV,EAAAA,EAAAA,KAAA,QAAMwC,EAAE,KAAKhC,EAAE,KAAKiC,MAAM,IAAIC,OAAO,IAAIhC,KAAK,eAGjD3D,EAAU,gBAAkB,6BAI/BoD,EAAAA,EAAAA,MAAA,OAAKF,UAAU,0BAAyBC,SAAA,EACtCF,EAAAA,EAAAA,KAAA,OAAKC,UAAU,6BACfD,EAAAA,EAAAA,KAAA,QAAMC,UAAU,wBAAuBC,SAAC,QACxCF,EAAAA,EAAAA,KAAA,OAAKC,UAAU,gCAIjBD,EAAAA,EAAAA,KAAA,UACEiB,QAASA,IAAMtE,EAAS,UACxBsD,UAAU,uBAAsBC,SACjC,2BAOLC,EAAAA,EAAAA,MAAA,OAAKF,UAAU,qCAAoCC,SAAA,EACjDF,EAAAA,EAAAA,KAAA,KAAGC,UAAU,6BAA4BC,SAAC,+BAG1CC,EAAAA,EAAAA,MAAA,KAAGF,UAAU,wBAAuBC,SAAA,CAAC,WAC1B7E,EAAaC,SAASqH,UAAU,EAAG,GAAG,mB","sources":["pages/auth/EntraAuth.js"],"sourcesContent":["/**\r\n * EntraAuth.js - Microsoft Entra ID Authentication\r\n * eSIM Enterprise Management Portal\r\n * \r\n * Tenant ID: 370dd52c-929e-4fcd-aee3-fb5181eff2b7\r\n * Client ID: 00f56c44-2d00-4378-bb52-1417c208fcfd\r\n * Redirect URI: https://www.esim.com.mm/auth\r\n */\r\n\r\nimport { useState, useEffect, useCallback } from 'react';\r\nimport { useNavigate, useSearchParams } from 'react-router-dom';\r\nimport { motion } from 'framer-motion';\r\n\r\n// Microsoft Entra ID Configuration\r\nconst ENTRA_CONFIG = {\r\n  tenantId: '370dd52c-929e-4fcd-aee3-fb5181eff2b7',\r\n  clientId: '00f56c44-2d00-4378-bb52-1417c208fcfd',\r\n  redirectUri: 'https://www.esim.com.mm/auth',\r\n  scopes: ['openid', 'profile', 'email', 'User.Read'],\r\n  \r\n  // Endpoints\r\n  authorizeEndpoint: 'https://login.microsoftonline.com/370dd52c-929e-4fcd-aee3-fb5181eff2b7/oauth2/v2.0/authorize',\r\n  tokenEndpoint: 'https://login.microsoftonline.com/370dd52c-929e-4fcd-aee3-fb5181eff2b7/oauth2/v2.0/token',\r\n  graphEndpoint: 'https://graph.microsoft.com/v1.0/me',\r\n  openIdConfig: 'https://login.microsoftonline.com/370dd52c-929e-4fcd-aee3-fb5181eff2b7/v2.0/.well-known/openid-configuration'\r\n};\r\n\r\n// Generate random state for CSRF protection\r\nconst generateState = () => {\r\n  const array = new Uint8Array(32);\r\n  window.crypto.getRandomValues(array);\r\n  return Array.from(array, byte => byte.toString(16).padStart(2, '0')).join('');\r\n};\r\n\r\n// Generate PKCE code verifier and challenge\r\nconst generatePKCE = async () => {\r\n  const verifier = generateState();\r\n  const encoder = new TextEncoder();\r\n  const data = encoder.encode(verifier);\r\n  const hash = await window.crypto.subtle.digest('SHA-256', data);\r\n  const challenge = btoa(String.fromCharCode(...new Uint8Array(hash)))\r\n    .replace(/\\+/g, '-')\r\n    .replace(/\\//g, '_')\r\n    .replace(/=+$/, '');\r\n  return { verifier, challenge };\r\n};\r\n\r\nconst EntraAuth = () => {\r\n  const navigate = useNavigate();\r\n  const [searchParams] = useSearchParams();\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const [user, setUser] = useState(null);\r\n\r\n  // Handle OAuth callback\r\n  const handleCallback = useCallback(async () => {\r\n    const code = searchParams.get('code');\r\n    const state = searchParams.get('state');\r\n    const errorParam = searchParams.get('error');\r\n    const errorDescription = searchParams.get('error_description');\r\n\r\n    if (errorParam) {\r\n      setError(`${errorParam}: ${errorDescription}`);\r\n      return;\r\n    }\r\n\r\n    if (code) {\r\n      setLoading(true);\r\n      \r\n      // Verify state\r\n      const savedState = sessionStorage.getItem('entra_state');\r\n      if (state !== savedState) {\r\n        setError('State mismatch - possible CSRF attack');\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      try {\r\n        // Get code verifier for PKCE\r\n        const codeVerifier = sessionStorage.getItem('entra_code_verifier');\r\n        \r\n        // Exchange code for token\r\n        const tokenResponse = await fetch(ENTRA_CONFIG.tokenEndpoint, {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/x-www-form-urlencoded'\r\n          },\r\n          body: new URLSearchParams({\r\n            client_id: ENTRA_CONFIG.clientId,\r\n            grant_type: 'authorization_code',\r\n            code: code,\r\n            redirect_uri: ENTRA_CONFIG.redirectUri,\r\n            code_verifier: codeVerifier\r\n          })\r\n        });\r\n\r\n        if (!tokenResponse.ok) {\r\n          throw new Error('Token exchange failed');\r\n        }\r\n\r\n        const tokens = await tokenResponse.json();\r\n        \r\n        // Store tokens\r\n        localStorage.setItem('entra_access_token', tokens.access_token);\r\n        if (tokens.refresh_token) {\r\n          localStorage.setItem('entra_refresh_token', tokens.refresh_token);\r\n        }\r\n        localStorage.setItem('entra_id_token', tokens.id_token);\r\n\r\n        // Fetch user profile from Microsoft Graph\r\n        const userResponse = await fetch(ENTRA_CONFIG.graphEndpoint, {\r\n          headers: {\r\n            'Authorization': `Bearer ${tokens.access_token}`\r\n          }\r\n        });\r\n\r\n        if (userResponse.ok) {\r\n          const userData = await userResponse.json();\r\n          setUser(userData);\r\n          localStorage.setItem('entra_user', JSON.stringify(userData));\r\n          \r\n          // Clear session storage\r\n          sessionStorage.removeItem('entra_state');\r\n          sessionStorage.removeItem('entra_code_verifier');\r\n          \r\n          // Redirect to dashboard after 2 seconds\r\n          setTimeout(() => navigate('/dashboard'), 2000);\r\n        }\r\n      } catch (err) {\r\n        setError(err.message);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    }\r\n  }, [searchParams, navigate]);\r\n\r\n  useEffect(() => {\r\n    handleCallback();\r\n  }, [handleCallback]);\r\n\r\n  // Initiate login\r\n  const handleLogin = async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      // Generate PKCE\r\n      const { verifier, challenge } = await generatePKCE();\r\n      const state = generateState();\r\n\r\n      // Store for callback verification\r\n      sessionStorage.setItem('entra_state', state);\r\n      sessionStorage.setItem('entra_code_verifier', verifier);\r\n\r\n      // Build authorization URL\r\n      const authUrl = new URL(ENTRA_CONFIG.authorizeEndpoint);\r\n      authUrl.searchParams.set('client_id', ENTRA_CONFIG.clientId);\r\n      authUrl.searchParams.set('response_type', 'code');\r\n      authUrl.searchParams.set('redirect_uri', ENTRA_CONFIG.redirectUri);\r\n      authUrl.searchParams.set('scope', ENTRA_CONFIG.scopes.join(' '));\r\n      authUrl.searchParams.set('state', state);\r\n      authUrl.searchParams.set('code_challenge', challenge);\r\n      authUrl.searchParams.set('code_challenge_method', 'S256');\r\n      authUrl.searchParams.set('response_mode', 'query');\r\n\r\n      // Redirect to Microsoft login\r\n      window.location.href = authUrl.toString();\r\n    } catch (err) {\r\n      setError(err.message);\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Logout\r\n  const handleLogout = () => {\r\n    localStorage.removeItem('entra_access_token');\r\n    localStorage.removeItem('entra_refresh_token');\r\n    localStorage.removeItem('entra_id_token');\r\n    localStorage.removeItem('entra_user');\r\n    setUser(null);\r\n    \r\n    // Redirect to Microsoft logout\r\n    const logoutUrl = `https://login.microsoftonline.com/${ENTRA_CONFIG.tenantId}/oauth2/v2.0/logout?post_logout_redirect_uri=${encodeURIComponent(ENTRA_CONFIG.redirectUri)}`;\r\n    window.location.href = logoutUrl;\r\n  };\r\n\r\n  // Check for existing session\r\n  useEffect(() => {\r\n    const savedUser = localStorage.getItem('entra_user');\r\n    if (savedUser) {\r\n      setUser(JSON.parse(savedUser));\r\n    }\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"min-h-screen py-20 flex items-center justify-center\">\r\n      <div className=\"max-w-md w-full mx-4\">\r\n        <motion.div\r\n          initial={{ opacity: 0, y: 20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          className=\"glass-card text-center\"\r\n        >\r\n          {/* Logo */}\r\n          <div className=\"mb-8\">\r\n            <div className=\"w-20 h-20 mx-auto mb-4 rounded-2xl bg-gradient-to-br from-primary to-blue-500 flex items-center justify-center\">\r\n              <svg className=\"w-10 h-10 text-background\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path d=\"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5\"/>\r\n              </svg>\r\n            </div>\r\n            <h1 className=\"text-2xl font-bold text-white mb-2\">\r\n              eSIM Enterprise Portal\r\n            </h1>\r\n            <p className=\"text-gray-400 text-sm\">\r\n              Microsoft Entra ID Authentication\r\n            </p>\r\n          </div>\r\n\r\n          {/* Error Message */}\r\n          {error && (\r\n            <div className=\"mb-6 p-4 bg-red-500/20 border border-red-500/30 rounded-lg\">\r\n              <p className=\"text-red-400 text-sm\">{error}</p>\r\n            </div>\r\n          )}\r\n\r\n          {/* User Profile (if logged in) */}\r\n          {user ? (\r\n            <div className=\"space-y-6\">\r\n              <div className=\"p-4 bg-green-500/20 border border-green-500/30 rounded-lg\">\r\n                <p className=\"text-green-400 text-sm mb-2\">Authenticated Successfully</p>\r\n                <p className=\"text-white font-semibold\">{user.displayName}</p>\r\n                <p className=\"text-gray-400 text-sm\">{user.mail || user.userPrincipalName}</p>\r\n              </div>\r\n\r\n              <div className=\"text-left space-y-2 p-4 bg-white/5 rounded-lg\">\r\n                <p className=\"text-xs text-gray-500\">User ID</p>\r\n                <p className=\"text-sm text-gray-300 font-mono break-all\">{user.id}</p>\r\n              </div>\r\n\r\n              <div className=\"flex gap-3\">\r\n                <button\r\n                  onClick={() => navigate('/dashboard')}\r\n                  className=\"flex-1 btn-primary\"\r\n                >\r\n                  Go to Dashboard\r\n                </button>\r\n                <button\r\n                  onClick={handleLogout}\r\n                  className=\"flex-1 btn-secondary\"\r\n                >\r\n                  Sign Out\r\n                </button>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-6\">\r\n              {/* Login Button */}\r\n              <button\r\n                onClick={handleLogin}\r\n                disabled={loading}\r\n                className=\"w-full btn-primary flex items-center justify-center gap-3\"\r\n              >\r\n                {loading ? (\r\n                  <div className=\"w-5 h-5 border-2 border-background border-t-transparent rounded-full animate-spin\" />\r\n                ) : (\r\n                  <svg className=\"w-5 h-5\" viewBox=\"0 0 21 21\" fill=\"currentColor\">\r\n                    <rect x=\"1\" y=\"1\" width=\"9\" height=\"9\" fill=\"#f25022\"/>\r\n                    <rect x=\"11\" y=\"1\" width=\"9\" height=\"9\" fill=\"#7fba00\"/>\r\n                    <rect x=\"1\" y=\"11\" width=\"9\" height=\"9\" fill=\"#00a4ef\"/>\r\n                    <rect x=\"11\" y=\"11\" width=\"9\" height=\"9\" fill=\"#ffb900\"/>\r\n                  </svg>\r\n                )}\r\n                {loading ? 'Signing in...' : 'Sign in with Microsoft'}\r\n              </button>\r\n\r\n              {/* Divider */}\r\n              <div className=\"flex items-center gap-4\">\r\n                <div className=\"flex-1 h-px bg-white/10\"></div>\r\n                <span className=\"text-gray-500 text-sm\">or</span>\r\n                <div className=\"flex-1 h-px bg-white/10\"></div>\r\n              </div>\r\n\r\n              {/* Alternative Login */}\r\n              <button\r\n                onClick={() => navigate('/login')}\r\n                className=\"w-full btn-secondary\"\r\n              >\r\n                Sign in with Email\r\n              </button>\r\n            </div>\r\n          )}\r\n\r\n          {/* Footer Info */}\r\n          <div className=\"mt-8 pt-6 border-t border-white/10\">\r\n            <p className=\"text-xs text-gray-500 mb-2\">\r\n              Enterprise Single Sign-On\r\n            </p>\r\n            <p className=\"text-xs text-gray-600\">\r\n              Tenant: {ENTRA_CONFIG.tenantId.substring(0, 8)}...\r\n            </p>\r\n          </div>\r\n        </motion.div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EntraAuth;\r\n"],"names":["ENTRA_CONFIG","tenantId","clientId","redirectUri","scopes","authorizeEndpoint","tokenEndpoint","graphEndpoint","openIdConfig","generateState","array","Uint8Array","window","crypto","getRandomValues","Array","from","byte","toString","padStart","join","EntraAuth","navigate","useNavigate","searchParams","useSearchParams","loading","setLoading","useState","error","setError","user","setUser","handleCallback","useCallback","async","code","get","state","errorParam","errorDescription","concat","sessionStorage","getItem","codeVerifier","tokenResponse","fetch","method","headers","body","URLSearchParams","client_id","grant_type","redirect_uri","code_verifier","ok","Error","tokens","json","localStorage","setItem","access_token","refresh_token","id_token","userResponse","userData","JSON","stringify","removeItem","setTimeout","err","message","useEffect","savedUser","parse","_jsx","className","children","_jsxs","motion","div","initial","opacity","y","animate","fill","viewBox","d","displayName","mail","userPrincipalName","id","onClick","handleLogout","logoutUrl","encodeURIComponent","location","href","verifier","challenge","data","TextEncoder","encode","hash","subtle","digest","btoa","String","fromCharCode","replace","generatePKCE","authUrl","URL","set","disabled","x","width","height","substring"],"ignoreList":[],"sourceRoot":""}